@model Pharma263.MVC.DTOs.Returns.ReturnsDto
@{
    ViewBag.Title = "Return Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="wraper container-fluid">
    <div class="page-title">
        <h1 class="title">Return Details - #@Model.Id</h1>
        <a href="@Url.Action("Index", "Return")" class="btn btn-default pull-right">
            <i class="fa fa-arrow-left"></i> Back to Returns
        </a>
        <div class="clearfix"></div>
    </div>
    
    <div class="row">
        <div class="col-lg-8">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Return Information</h2>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-6">
                            <dl class="dl-horizontal">
                                <dt>Return ID:</dt>
                                <dd><strong>#@Model.Id</strong></dd>
                                
                                <dt>Sale ID:</dt>
                                <dd>
                                    <a href="@Url.Action("Details", "Sale", new { id = Model.SaleId })" class="text-primary">
                                        <strong>#@Model.SaleId</strong>
                                    </a>
                                </dd>
                                
                                <dt>Medicine:</dt>
                                <dd><strong>@Model.MedicineName</strong></dd>
                                
                                <dt>Quantity:</dt>
                                <dd>@Model.Quantity units</dd>
                            </dl>
                        </div>
                        <div class="col-md-6">
                            <dl class="dl-horizontal">
                                <dt>Date Returned:</dt>
                                <dd>@Model.DateReturned.ToString("MMM dd, yyyy")</dd>
                                
                                <dt>Return Reason:</dt>
                                <dd>
                                    @if (Model.ReturnReason == "Expired Product")
                                    {
                                        <span class="label label-warning">@Model.ReturnReason</span>
                                    }
                                    else if (Model.ReturnReason == "Damaged")
                                    {
                                        <span class="label label-danger">@Model.ReturnReason</span>
                                    }
                                    else if (Model.ReturnReason == "Factory Recall")
                                    {
                                        <span class="label label-info">@Model.ReturnReason</span>
                                    }
                                    else
                                    {
                                        <span class="label label-default">@Model.ReturnReason</span>
                                    }
                                </dd>
                                
                                <dt>Destination:</dt>
                                <dd>
                                    @if (Model.ReturnDestination == "Stock Update")
                                    {
                                        <span class="label label-success">@Model.ReturnDestination</span>
                                    }
                                    else if (Model.ReturnDestination == "Quarantine")
                                    {
                                        <span class="label label-warning">@Model.ReturnDestination</span>
                                    }
                                    else if (Model.ReturnDestination == "Disposal")
                                    {
                                        <span class="label label-danger">@Model.ReturnDestination</span>
                                    }
                                    else if (Model.ReturnDestination == "Supplier")
                                    {
                                        <span class="label label-info">@Model.ReturnDestination</span>
                                    }
                                    else
                                    {
                                        <span class="label label-default">@Model.ReturnDestination</span>
                                    }
                                </dd>
                                
                                <dt>Status:</dt>
                                <dd>
                                    @if (Model.ReturnStatus == "Decision Pending")
                                    {
                                        <span class="label label-warning">@Model.ReturnStatus</span>
                                    }
                                    else if (Model.ReturnStatus == "Quarantined")
                                    {
                                        <span class="label label-info">@Model.ReturnStatus</span>
                                    }
                                    else if (Model.ReturnStatus == "Disposed")
                                    {
                                        <span class="label label-danger">@Model.ReturnStatus</span>
                                    }
                                    else if (Model.ReturnStatus == "Returned To Supplier")
                                    {
                                        <span class="label label-primary">@Model.ReturnStatus</span>
                                    }
                                    else
                                    {
                                        <span class="label label-success">@Model.ReturnStatus</span>
                                    }
                                </dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h2 class="panel-title">Actions</h2>
                </div>
                <div class="panel-body">
                    <div class="btn-group-vertical btn-block" role="group">
                        <a href="@Url.Action("Details", "Sale", new { id = Model.SaleId })" 
                           class="btn btn-primary">
                            <i class="fa fa-file-text"></i> View Original Sale
                        </a>
                        
                        @if (Model.ReturnStatus != "Completed")
                        {
                            <a href="@Url.Action("Complete", "Return", new { id = Model.Id })" 
                               class="btn btn-success">
                                <i class="fa fa-check"></i> Complete Return
                            </a>
                        }
                        
                        <a href="@Url.Action("PrintReceipt", "Return", new { id = Model.Id })" 
                           target="_blank" class="btn btn-info">
                            <i class="fa fa-print"></i> Print Receipt
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Processing Information</h2>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="alert @(Model.ReturnDestination == "Stock Update" ? "alert-success" : "alert-warning")">
                                @if (Model.ReturnDestination == "Stock Update")
                                {
                                    <text><i class="fa fa-check-circle"></i> <strong>Stock Updated:</strong> This item was returned to stock and is available for sale.</text>
                                }
                                else if (Model.ReturnReason == "Damaged")
                                {
                                    <text><i class="fa fa-exclamation-triangle"></i> <strong>Damaged Item:</strong> This item was marked as damaged and processed accordingly.</text>
                                }
                                else if (Model.ReturnReason == "Expired Product")
                                {
                                    <text><i class="fa fa-calendar-times"></i> <strong>Expired Product:</strong> This item was marked as expired and processed accordingly.</text>
                                }
                                else if (Model.ReturnReason == "Factory Recall")
                                {
                                    <text><i class="fa fa-warning"></i> <strong>Factory Recall:</strong> This item was recalled by the manufacturer.</text>
                                }
                                else
                                {
                                    <text><i class="fa fa-info-circle"></i> <strong>Processed:</strong> This item was processed according to the return reason: @Model.ReturnReason</text>
                                }
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h5><i class="fa fa-map-marker"></i> Destination Details</h5>
                            <p class="text-muted">
                                @switch (Model.ReturnDestination)
                                {
                                    case "Stock Update":
                                        <span>The returned items have been added back to the available stock inventory and are ready for sale.</span>
                                        break;
                                    case "Quarantine":
                                        <span>The returned items have been placed in quarantine for further inspection or disposal.</span>
                                        break;
                                    case "Supplier":
                                        <span>The returned items are scheduled to be returned to the supplier.</span>
                                        break;
                                    case "Disposal":
                                        <span>The returned items have been marked for disposal and removed from inventory.</span>
                                        break;
                                    default:
                                        <span>The items were processed according to the destination: @Model.ReturnDestination</span>
                                        break;
                                }
                            </p>
                        </div>
                        <div class="col-md-6">
                            <h5><i class="fa fa-info-circle"></i> Return Summary</h5>
                            <ul class="list-unstyled text-muted">
                                <li><strong>Reason:</strong> @Model.ReturnReason</li>
                                <li><strong>Destination:</strong> @Model.ReturnDestination</li>
                                <li><strong>Status:</strong> @Model.ReturnStatus</li>
                                <li><strong>Processed:</strong> @Model.DateReturned.ToString("MMM dd, yyyy")</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>