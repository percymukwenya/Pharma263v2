@{
    ViewBag.Title = "Create New Purchase";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@* Inline styles moved to /css/modules/common-overrides.css, forms.css, and purchases.css *@
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />

<div class="wraper container-fluid">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Create New Purchase</h3>
            </div>
            <div class="panel-body">
                <!-- Supplier and Date Section -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="Supplier">Supplier : </label>
                            <select id="Supplier" class="form-control" onchange="blankme(this.id)">
                                <option value="">Select Supplier</option>
                            </select>
                            <small id="error_Supplier" class="form-text error_msg">Select supplier from list</small>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="Date">Purchase Date : </label>
                            @Html.TextBox("Date", null, new { @class = "form-control mydatepicker", @placeholder = "Select Purchase Date", onchange = "blankme(this.id)" })
                            <small id="error_Date" class="form-text error_msg">Purchase Date is Required</small>
                        </div>
                    </div>
                </div>

                <!-- Product Section - Improved Layout -->
                <div class="product-section">
                    <!-- Product Selection Form -->
                    <div class="product-form">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">Add Item</h3>
                            </div>
                            <div class="panel-body">
                                <form role="form">
                                    <div class="form-group">
                                        <label for="Medicine">Medicine : </label>
                                        <select id="Medicine" class="form-control">
                                            <option value="">Search for a medicine...</option>
                                        </select>
                                        <small id="error_Medicine" class="form-text error_msg">Select Medicine from list</small>
                                    </div>
                                    <div class="form-group" id="medicineDetails">
                                        <!-- Medicine details will be populated here -->
                                    </div>
                                    <div class="form-group">
                                        <label for="Quantity">Quantity : </label>
                                        @Html.TextBox("Quantity", null, new { @class = "form-control", @type = "number", @placeholder = "Enter Quantity", @min = "0" })
                                        <small id="error_Quantity" class="form-text error_msg">Quantity is required</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="DiscountPercent">Discount % : </label>
                                        @Html.TextBox("DiscountPercent", null, new { @class = "form-control", @type = "number", @placeholder = "Enter Discount %", @min = "0", @max = "100", @step = "0.01" })
                                        <small id="error_DiscountPercent" class="form-text error_msg">Discount must be between 0-100%</small>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" id="addToList" class="btn btn-info btn-block">
                                            Add To List
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Product List -->
                    <div class="product-list">
                        <div class="panel panel-color panel-primary">
                            <div class="panel-heading">
                                <h3 class="panel-title">Product List</h3>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="detailsTable">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>Name</th>
                                                <th>Batch No</th>
                                                <th>Expiry</th>
                                                <th>Buying $</th>
                                                <th>Selling $</th>
                                                <th>Discount %</th>
                                                <th>Qty</th>
                                                <th>Amount</th>
                                                <th style="width:20px"></th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                        <tfoot>
                                            <tr>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td><strong>Total:</strong></td>
                                                <td><strong id="SubTotal"></strong></td>
                                                <td></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                                <small id="error_SubTotal" class="form-text error_msg">At least add one item</small>
                            </div>
                        </div>

                        <!-- Purchase Details Section -->
                        <div class="row">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label for="Notes">Notes: </label>
                                    @Html.TextArea("Notes", new { @class = "form-control", @rows = "2", @placeholder = "Enter Notes" })
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="PaymentMethod">Payment Method : </label>
                                            <select id="PaymentMethod" class="form-control" onchange="blankme(this.id)">
                                                <option value="">Select Payment Method</option>
                                            </select>
                                            <small id="error_PaymentMethod" class="form-text error_msg">Select Payment Method</small>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="PurchaseStatus">Purchase Status : </label>
                                            <select id="PurchaseStatus" class="form-control" onchange="blankme(this.id)">
                                                <option value="">Select Purchase Status</option>
                                            </select>
                                            <small id="error_PurchaseStatus" class="form-text error_msg">Select Purchase Status</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="Discount">Discount : </label>
                                    @Html.TextBox("Discount", 0, new { @class = "form-control", @Value = "0", @type = "number", @placeholder = "Discount Amount", onchange = "DiscountAmount()" })
                                    <small id="error_Discount" class="form-text error_msg">Discount can't be empty</small>
                                </div>
                                <div class="form-group">
                                    <label for="GrandTotal">Grand Total : </label>
                                    <h5 id="GrandTotal" class="form-control"></h5>
                                    <small id="error_GrandTotal" class="form-text error_msg">Total is empty</small>
                                </div>

                                <div class="form-group">
                                    <input id="BtnSave" class="btn btn-success btn-block" type="submit" value="Save Purchase" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add these in your layout or at the end of the view (before the scripts section) -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />



@section scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="~/Scripts/App/App.js"></script>

    <script type="text/javascript">
        function disableButton() {
            document.getElementById("BtnSave").disabled = true;
        }
    </script>
}
