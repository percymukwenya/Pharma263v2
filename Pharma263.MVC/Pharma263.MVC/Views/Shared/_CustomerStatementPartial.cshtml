@model Pharma263.Integration.Api.Models.Response.CustomerStatementResponse

<!-- Customer Information -->
<div class="row">
    <div class="col-md-6">
        <h4><strong>@Model.CustomerName</strong></h4>
        <p>
            <i class="fa fa-envelope"></i> @Model.Email<br />
            <i class="fa fa-phone"></i> @Model.Phone
        </p>
    </div>
    <div class="col-md-6 text-right">
        <h5><strong>Statement Period</strong></h5>
        <p>@Model.StatementPeriod.StartDate.ToString("MMM dd, yyyy") - @Model.StatementPeriod.EndDate.ToString("MMM dd, yyyy")</p>
        <p><small>Generated: @Model.GeneratedDate.ToString("MMM dd, yyyy hh:mm tt")</small></p>
    </div>
</div>

<hr />

<!-- Account Summary -->
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-info">
            <div class="panel-heading">
                <h4 class="panel-title">Account Summary</h4>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="text-center">
                            <h4 class="text-primary">@Model.TotalDebits.ToString("C2")</h4>
                            <p>Total Charges</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h4 class="text-success">@Model.TotalCredits.ToString("C2")</h4>
                            <p>Total Payments</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h4 class="@(Model.CurrentBalance > 0 ? "text-danger" : "text-success")">
                                @Model.CurrentBalance.ToString("C2")
                            </h4>
                            <p>Current Balance</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h4 class="text-info">@Model.Transactions.Count</h4>
                            <p>Total Transactions</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Transaction History -->
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">Transaction History</h4>
            </div>
            <div class="panel-body">
                @if (!Model.Transactions.Any())
                {
                    <div class="alert alert-info">
                        <i class="fa fa-info-circle"></i> No transactions found for the selected period.
                    </div>
                }
                else
                {
                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="transactionTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th class="text-right">Charges</th>
                                    <th class="text-right">Payments</th>
                                    <th class="text-right">Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var transaction in Model.Transactions.OrderBy(t => t.TransactionDate))
                                {
                                    <tr>
                                        <td>@transaction.TransactionDate.ToString("MMM dd, yyyy")</td>
                                        <td>
                                            <span class="label @(GetTransactionLabelClass(transaction.TransactionType))">
                                                @transaction.TransactionType
                                            </span>
                                        </td>
                                        <td>@transaction.Description</td>
                                        <td class="text-right">
                                            @if (transaction.DebitAmount > 0)
                                            {
                                                <span class="text-danger">@transaction.DebitAmount.ToString("C2")</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">-</span>
                                            }
                                        </td>
                                        <td class="text-right">
                                            @if (transaction.CreditAmount > 0)
                                            {
                                                <span class="text-success">@transaction.CreditAmount.ToString("C2")</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">-</span>
                                            }
                                        </td>
                                        <td class="text-right">
                                            <strong class="@(transaction.RunningBalance > 0 ? "text-danger" : transaction.RunningBalance < 0 ? "text-success" : "text-muted")">
                                                @transaction.RunningBalance.ToString("C2")
                                            </strong>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr class="info">
                                    <th colspan="3">Totals</th>
                                    <th class="text-right">@Model.TotalDebits.ToString("C2")</th>
                                    <th class="text-right">@Model.TotalCredits.ToString("C2")</th>
                                    <th class="text-right">
                                        <strong class="@(Model.CurrentBalance > 0 ? "text-danger" : "text-success")">
                                            @Model.CurrentBalance.ToString("C2")
                                        </strong>
                                    </th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@functions {
    string GetTransactionLabelClass(string transactionType)
    {
        switch (transactionType?.ToLower())
        {
            case "sale":
                return "label-primary";
            case "payment":
                return "label-success";
            case "return":
                return "label-warning";
            default:
                return "label-default";
        }
    }
}
